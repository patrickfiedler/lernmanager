{% extends 'base.html' %}

{% block title %}{% if task %}Thema bearbeiten{% else %}Neues Thema{% endif %} - Lernmanager{% endblock %}

{% block content %}
<h1 class="mb-2">{% if task %}üìù Thema bearbeiten{% else %}‚ûï Neues Thema{% endif %}</h1>

<div class="card">
    <form method="POST" action="{% if task %}{{ url_for('admin_thema_bearbeiten', task_id=task.id) }}{% else %}{{ url_for('admin_thema_neu') }}{% endif %}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="grid grid-2">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" class="form-control" value="{{ task.name if task else '' }}" required>
            </div>

            <div class="form-group">
                <label for="number">Nummer (f√ºr Sortierung)</label>
                <input type="number" id="number" name="number" class="form-control" value="{{ task.number if task else 0 }}" min="0" required>
            </div>

            <div class="form-group">
                <label for="fach">Fach</label>
                <select id="fach" name="fach" class="form-control" required>
                    {% for subject in subjects %}
                    <option value="{{ subject }}" {% if task and task.fach == subject %}selected{% endif %}>{{ subject }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="stufe">Stufe</label>
                <select id="stufe" name="stufe" class="form-control" required>
                    {% for level in levels %}
                    <option value="{{ level }}" {% if task and task.stufe == level %}selected{% endif %}>{{ level }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="kategorie">Kategorie</label>
                <select id="kategorie" name="kategorie" class="form-control" required>
                    <option value="pflicht" {% if task and task.kategorie == 'pflicht' %}selected{% endif %}>Pflicht</option>
                    <option value="bonus" {% if task and task.kategorie == 'bonus' %}selected{% endif %}>‚≠ê Bonus</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="lernziel">Lernziel (Lehrkraft) <small class="text-muted">‚ÄûDie SuS k√∂nnen‚Ä¶"</small></label>
            <textarea id="lernziel" name="lernziel" class="form-control" rows="2">{{ task.lernziel if task else '' }}</textarea>
        </div>
        <div class="form-group">
            <label for="lernziel_schueler">Lernziel (Sch√ºler) <small class="text-muted">optional ‚Äî ‚ÄûDu lernst‚Ä¶"</small></label>
            <textarea id="lernziel_schueler" name="lernziel_schueler" class="form-control" rows="2">{{ task.lernziel_schueler if task else '' }}</textarea>
            <small class="text-muted">Wenn leer, sehen Sch√ºler das Lehrkraft-Lernziel.</small>
        </div>

        <div class="form-group">
            <label for="beschreibung">Beschreibung</label>
            <textarea id="beschreibung" name="beschreibung" class="form-control" rows="4">{{ task.beschreibung if task else '' }}</textarea>
        </div>

        <div class="form-group">
            <label for="why_learn_this">Wof√ºr brauchen die Sch√ºler das? üí°</label>
            <textarea id="why_learn_this" name="why_learn_this" class="form-control" rows="2" placeholder="z.B. 'Du lernst, wie Computer funktionieren - das brauchst du, um digitale Ger√§te zu verstehen.'">{{ task.why_learn_this if task else '' }}</textarea>
            <small class="text-muted">Kurze Erkl√§rung (1-2 S√§tze), altersgerecht f√ºr Stufe {{ task.stufe if task else 'X/Y' }}. Wird den Sch√ºlern prominent angezeigt.</small>
        </div>

        <button type="submit" class="btn btn-primary">{% if task %}Speichern{% else %}Erstellen{% endif %}</button>
        <a href="{{ url_for('admin_themen') }}" class="btn btn-secondary">Abbrechen</a>
    </form>
</div>
{% endblock %}
